export const MOCK_CITY_STATS = {
    "hourlySummary": [
        {
            "district": "Quận 8",
            "hour": "2025-12-30T15:15:00",
            "totalCount": 69,
            "detectionDetailsSummary": {
                "motorcycle": 41,
                "other": 2,
                "car": 22,
                "truck": 4
            }
        },
        {
            "district": "Quận 4",
            "hour": "2025-12-30T15:15:00",
            "totalCount": 59,
            "detectionDetailsSummary": {
                "motorcycle": 21,
                "other": 3,
                "car": 33,
                "truck": 2
            }
        },
        {
            "district": "Quận Tân Phú",
            "hour": "2025-12-30T15:15:00",
            "totalCount": 32,
            "detectionDetailsSummary": {
                "motorcycle": 9,
                "other": 1,
                "car": 13,
                "truck": 9
            }
        },
        {
            "district": "Quận 9",
            "hour": "2025-12-30T15:15:00",
            "totalCount": 84,
            "detectionDetailsSummary": {
                "motorcycle": 31,
                "other": 2,
                "car": 29,
                "truck": 22
            }
        },
        {
            "district": "Quận 1",
            "hour": "2025-12-30T15:15:00",
            "totalCount": 305,
            "detectionDetailsSummary": {
                "motorcycle": 109,
                "other": 6,
                "car": 181,
                "truck": 9
            }
        },
        {
            "district": "Quận 12",
            "hour": "2025-12-30T15:15:00",
            "totalCount": 256,
            "detectionDetailsSummary": {
                "motorcycle": 26,
                "other": 60,
                "car": 112,
                "truck": 58
            }
        },
        {
            "district": "Quận 11",
            "hour": "2025-12-30T15:15:00",
            "totalCount": 73,
            "detectionDetailsSummary": {
                "motorcycle": 31,
                "other": 5,
                "car": 31,
                "truck": 6
            }
        },
        {
            "district": "Quận Bình Tân",
            "hour": "2025-12-30T15:15:00",
            "totalCount": 152,
            "detectionDetailsSummary": {
                "motorcycle": 35,
                "other": 11,
                "car": 62,
                "truck": 44
            }
        },
        {
            "district": "Quận 3",
            "hour": "2025-12-30T15:15:00",
            "totalCount": 229,
            "detectionDetailsSummary": {
                "motorcycle": 85,
                "other": 7,
                "car": 125,
                "truck": 12
            }
        },
        {
            "district": "Quận 7",
            "hour": "2025-12-30T15:15:00",
            "totalCount": 95,
            "detectionDetailsSummary": {
                "motorcycle": 28,
                "other": 8,
                "car": 36,
                "truck": 23
            }
        },
        {
            "district": "Quận 2",
            "hour": "2025-12-30T15:15:00",
            "totalCount": 180,
            "detectionDetailsSummary": {
                "motorcycle": 37,
                "other": 15,
                "car": 98,
                "truck": 30
            }
        },
        {
            "district": "Huyện Bình Chánh",
            "hour": "2025-12-30T15:15:00",
            "totalCount": 141,
            "detectionDetailsSummary": {
                "motorcycle": 20,
                "other": 11,
                "car": 74,
                "truck": 36
            }
        },
        {
            "district": "Quận 10",
            "hour": "2025-12-30T15:15:00",
            "totalCount": 174,
            "detectionDetailsSummary": {
                "motorcycle": 90,
                "other": 2,
                "car": 78,
                "truck": 4
            }
        },
        {
            "district": "Quận Bình Thạnh",
            "hour": "2025-12-30T15:15:00",
            "totalCount": 395,
            "detectionDetailsSummary": {
                "motorcycle": 159,
                "other": 12,
                "car": 194,
                "truck": 30
            }
        },
        {
            "district": "Quận 6",
            "hour": "2025-12-30T15:15:00",
            "totalCount": 46,
            "detectionDetailsSummary": {
                "motorcycle": 17,
                "other": 7,
                "car": 15,
                "truck": 7
            }
        },
        {
            "district": "Quận Gò Vấp",
            "hour": "2025-12-30T15:15:00",
            "totalCount": 90,
            "detectionDetailsSummary": {
                "motorcycle": 53,
                "other": 4,
                "car": 29,
                "truck": 4
            }
        },
        {
            "district": "Quận Thủ Đức",
            "hour": "2025-12-30T15:15:00",
            "totalCount": 281,
            "detectionDetailsSummary": {
                "motorcycle": 65,
                "other": 24,
                "car": 138,
                "truck": 54
            }
        },
        {
            "district": "Huyện Nhà Bè",
            "hour": "2025-12-30T15:15:00",
            "totalCount": 1,
            "detectionDetailsSummary": {
                "truck": 1
            }
        },
        {
            "district": "Quận Tân Bình",
            "hour": "2025-12-30T15:15:00",
            "totalCount": 233,
            "detectionDetailsSummary": {
                "motorcycle": 68,
                "other": 7,
                "car": 143,
                "truck": 15
            }
        },
        {
            "district": "Quận 5",
            "hour": "2025-12-30T15:15:00",
            "totalCount": 129,
            "detectionDetailsSummary": {
                "motorcycle": 42,
                "other": 4,
                "car": 69,
                "truck": 14
            }
        },
        {
            "district": "Quận Phú Nhuận",
            "hour": "2025-12-30T15:15:00",
            "totalCount": 87,
            "detectionDetailsSummary": {
                "motorcycle": 36,
                "other": 1,
                "car": 44,
                "truck": 6
            }
        },
        {
            "district": "Huyện Hóc Môn",
            "hour": "2025-12-30T15:15:00",
            "totalCount": 47,
            "detectionDetailsSummary": {
                "motorcycle": 24,
                "other": 6,
                "car": 13,
                "truck": 4
            }
        }
    ],
    "fastestGrowing": [
        {
            "district": "Quận 7",
            "growthRate": 100,
            "currentCount": 26,
            "previousCount": 0
        },
        {
            "district": "Quận 8",
            "growthRate": 100,
            "currentCount": 22,
            "previousCount": 0
        },
        {
            "district": "Quận Tân Bình",
            "growthRate": 100,
            "currentCount": 64,
            "previousCount": 0
        },
        {
            "district": "Quận 11",
            "growthRate": 100,
            "currentCount": 20,
            "previousCount": 0
        },
        {
            "district": "Quận 9",
            "growthRate": 100,
            "currentCount": 25,
            "previousCount": 0
        }
    ],
    "vehicleRatio": [
        {
            "vehicleType": "car",
            "count": 1539,
            "percentage": 48.73
        },
        {
            "vehicleType": "motorcycle",
            "count": 1027,
            "percentage": 32.52
        },
        {
            "vehicleType": "truck",
            "count": 394,
            "percentage": 12.48
        },
        {
            "vehicleType": "bus",
            "count": 189,
            "percentage": 5.98
        },
        {
            "vehicleType": "bicycle",
            "count": 9,
            "percentage": 0.28
        }
    ],
    "busiestDistricts": [
        {
            "name": "Quận Bình Thạnh",
            "count": 111
        },
        {
            "name": "Quận 1",
            "count": 91
        },
        {
            "name": "Quận Thủ Đức",
            "count": 75
        },
        {
            "name": "Quận 3",
            "count": 67
        },
        {
            "name": "Quận Tân Bình",
            "count": 64
        }
    ],
    "busiestCameras": [
        {
            "name": "Nút giao Ngã sáu Nguyễn Tri Phương",
            "count": 12
        },
        {
            "name": "Nút giao Công Trường Dân Chủ",
            "count": 11
        },
        {
            "name": "Cách Mạng Tháng Tám - Nguyễn Thị Minh Khai",
            "count": 8
        },
        {
            "name": "Ba Tháng Hai - Cao Thắng",
            "count": 6
        },
        {
            "name": "Ba Tháng Hai - Lê Hồng Phong 1",
            "count": 6
        }
    ],
    "timestamp": 1767082566002
}

export function getRandomCityStats() {
    const stats = JSON.parse(JSON.stringify(MOCK_CITY_STATS));

    const now = new Date();
    const pad = (n: number) => n.toString().padStart(2, '0');
    const currentHourStr = `${now.getFullYear()}-${pad(now.getMonth() + 1)}-${pad(now.getDate())}T${pad(now.getHours())}:${pad(now.getMinutes())}:00`;

    // Randomize hourlySummary
    stats.hourlySummary = stats.hourlySummary.map((item: any) => {
        const randomFactor = 0.8 + Math.random() * 0.4; // 0.8 to 1.2
        const newTotal = Math.floor(item.totalCount * randomFactor);

        const newDetails: any = {};
        let sumDetails = 0;
        Object.keys(item.detectionDetailsSummary).forEach(key => {
            newDetails[key] = Math.floor(item.detectionDetailsSummary[key] * randomFactor);
            sumDetails += newDetails[key];
        });

        return {
            ...item,
            hour: currentHourStr,
            totalCount: sumDetails, // Ensure consistency
            detectionDetailsSummary: newDetails
        };
    });

    // Randomize fastestGrowing
    stats.fastestGrowing = stats.fastestGrowing.map((item: any) => ({
        ...item,
        currentCount: Math.floor(item.currentCount * (0.9 + Math.random() * 0.2)),
        growthRate: Math.floor(item.growthRate * (0.9 + Math.random() * 0.2))
    }));

    // Randomize vehicleRatio
    let totalVehicles = 0;
    stats.vehicleRatio = stats.vehicleRatio.map((item: any) => {
        const newCount = Math.floor(item.count * (0.9 + Math.random() * 0.2));
        totalVehicles += newCount;
        return { ...item, count: newCount };
    });

    stats.vehicleRatio = stats.vehicleRatio.map((item: any) => ({
        ...item,
        percentage: parseFloat(((item.count / totalVehicles) * 100).toFixed(2))
    }));

    // Randomize busiestDistricts
    stats.busiestDistricts = stats.busiestDistricts.map((item: any) => ({
        ...item,
        count: Math.floor(item.count * (0.9 + Math.random() * 0.2))
    })).sort((a: any, b: any) => b.count - a.count);

    // Randomize busiestCameras
    stats.busiestCameras = stats.busiestCameras.map((item: any) => ({
        ...item,
        count: Math.floor(item.count * (0.9 + Math.random() * 0.2))
    })).sort((a: any, b: any) => b.count - a.count);

    stats.timestamp = Date.now();

    return stats;
}

export function generateMockMinuteSummary() {
    const now = new Date();
    const summary: Record<string, number> = {};

    // Generate data for the last 60 minutes
    for (let i = 60; i >= 0; i--) {
        const d = new Date(now.getTime() - i * 60000);
        // Format: YYYY-MM-DDTHH:mm:ss in Local Time to match frontend parsing
        const pad = (n: number) => n.toString().padStart(2, '0');
        const key = `${d.getFullYear()}-${pad(d.getMonth() + 1)}-${pad(d.getDate())}T${pad(d.getHours())}:${pad(d.getMinutes())}:${pad(d.getSeconds())}`;
        if (i >= 18 && i <= 22) {
            summary[key] = Math.floor(Math.random() * 5000) + 1000;
        } else {
            summary[key] = 0;
        }
    }
    return summary;
}

export const MOCK_MINUTE_SUMMARY = generateMockMinuteSummary();

